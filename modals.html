<!-- Fragments de modals injectÃ©s dans index.html au chargement -->

<div class="quest-completion-modal" id="towerCompletionModal">
    <div class="quest-completion-content">
        <div class="quest-completion-title">ğŸ† FIN DE L'ASCENSION ğŸ†</div>
        <div id="towerCompletionInfo"></div>
        <div class="quest-completion-rewards" id="towerCompletionRewards"></div>
        <button id="closeTowerBtn" class="btn btn-save" style="font-size: 18px; padding: 15px 30px;">
            Fermer
        </button>
    </div>
</div>

<div id="statsModal" class="stats-modal">
    <div class="stats-content">
        <div class="stats-header">
            <h2>ğŸ“Š Statistiques</h2>
            <button class="stats-close" onclick="game.closeStatsModal()">Fermer</button>
        </div>
        <div id="statsDisplay"></div>
    </div>
</div>

<div id="bonusModal" class="stats-modal">
    <div class="stats-content" onclick="event.stopPropagation()">
        <div class="stats-header" style="border-bottom-color: #8b5cf6;">
            <h2 style="color: #8b5cf6;">ğŸ Bonus & Boutique</h2>
            <button class="stats-close" onclick="game.closeBonusModal()">Fermer</button>
        </div>
        <div id="bonusDisplay"></div>
    </div>
</div>

<div id="toastContainer" class="toastContainer"></div>

<div class="quest-completion-modal" id="eggHatchModal" onclick="game.closeEggHatchModal()">
    <div class="quest-completion-content" id="eggHatchContent" onclick="event.stopPropagation()">
    </div>
</div>

<div class="stats-modal" id="creatureModal" onclick="game.closeCreatureModal()">
    <div class="stats-content" id="creatureModalContent" onclick="event.stopPropagation()">
    </div>
</div>

<div class="stats-modal" id="zoneTierModal" onclick="closeZoneTierModal()">
    <div class="stats-content" id="zoneTierModalContent" onclick="event.stopPropagation()">
        <div class="stats-header">
            <h2 id="zoneTierModalTitle">Progression de la Zone</h2>
            <button class="stats-close" onclick="closeZoneTierModal()">Fermer</button>
        </div>
        <div class="team-list" id="zoneTierModalGrid"></div>
    </div>
</div>

<div class="stats-modal" id="synergyListModal" onclick="closeSynergyListModal()">
    <div class="stats-content" onclick="event.stopPropagation()" style="max-width: 700px;">
        <div class="stats-header">
            <h2>Guide des Synergies</h2>
            <button class="stats-close" onclick="closeSynergyListModal()">Fermer</button>
        </div>
        <div id="synergyListContent" class="synergy-list-grid"></div>
    </div>
</div>

<div class="stats-modal" id="relicModal">
    <div class="stats-content" style="text-align: center;">
        <div class="stats-header">
            <h2>ğŸ RÃ©compense d'Ã‰tage</h2>
        </div>
        <p style="margin-bottom: 20px;">Choisissez une relique pour la suite de l'ascension :</p>
        <div id="relicOptionsGrid" class="items-grid"></div>
    </div>
</div>

<div class="quest-completion-modal" id="captureModal">
    <div class="quest-completion-content" style="max-width: 500px;">
        <div class="quest-completion-title" style="color: #ff6b6b;">Ennemi Vaincu !</div>
        <div style="margin: 20px 0;">
            <img id="captureSprite" src="" style="width: 96px; height: 96px;">
            <h3 id="captureName" style="margin-top: 10px;"></h3>
            <p id="captureChanceText" style="color: #666; font-size: 14px;"></p>
        </div>
        <div id="captureButtons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;"></div>
        <button class="btn" style="background: #ef4444; color: white; width: 100%;" onclick="game.skipCapture()">
            Ne pas capturer (Partir)
        </button>
    </div>
</div>

<div class="stats-modal" id="starterModal" style="background: rgba(0,0,0,0.95); z-index: 20000;">
    <div class="stats-content" style="max-width: 900px; text-align: center; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);">
        <h1 style="color: #333; margin-bottom: 10px; font-size: 32px;">Bienvenue, Dresseur !</h1>
        <p style="color: #666; margin-bottom: 30px; font-size: 18px;">Le monde des crÃ©atures vous attend. Choisissez votre premier compagnon pour dÃ©buter l'aventure.</p>
        <div class="starter-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
            <div class="starter-card" onclick="game.selectStarter('grass')">
                <div class="starter-bg grass"></div>
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" class="starter-sprite">
                <h2 style="color: #2e7d32;">Bulbasaur</h2>
                <div class="type-badge type-grass">Plante</div>
                <div class="type-badge type-poison">Poison</div>
                <p>Un PokÃ©mon Ã©quilibrÃ©, idÃ©al pour les dÃ©butants.</p>
            </div>
            <div class="starter-card" onclick="game.selectStarter('fire')">
                <div class="starter-bg fire"></div>
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" class="starter-sprite">
                <h2 style="color: #c62828;">Charmander</h2>
                <div class="type-badge type-fire">Feu</div>
                <p>Une puissance offensive redoutable une fois Ã©voluÃ©.</p>
            </div>
            <div class="starter-card" onclick="game.selectStarter('water')">
                <div class="starter-bg water"></div>
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" class="starter-sprite">
                <h2 style="color: #1565c0;">Squirtle</h2>
                <div class="type-badge type-water">Eau</div>
                <p>Une dÃ©fense solide pour rÃ©sister aux assauts.</p>
            </div>
        </div>
    </div>
</div>

<div class="stats-modal" id="saveManagerModal" onclick="game.closeSaveManager()">
    <div class="stats-content" onclick="event.stopPropagation()" style="max-width: 500px; text-align: center;">
        <div class="stats-header">
            <h2>â˜° Menu Principal</h2>
            <button class="stats-close" onclick="game.closeSaveManager()">Fermer</button>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 25px;">
            <button class="btn" onclick="game.openStatsModal(); game.closeSaveManager();" style="background: #3b82f6; color: white; padding: 15px 5px; font-size: 13px; display:flex; flex-direction:column; align-items:center; gap:5px;">
                <span style="font-size: 20px;">ğŸ“Š</span> Stats
            </button>
            <button class="btn" onclick="game.openBonusModal(); game.closeSaveManager();" style="background: #8b5cf6; color: white; padding: 15px 5px; font-size: 13px; display:flex; flex-direction:column; align-items:center; gap:5px;">
                <span style="font-size: 20px;">ğŸ</span> Bonus
            </button>
            <button class="btn" onclick="game.openLogModal(); game.closeSaveManager();" style="background: #10b981; color: white; padding: 15px 5px; font-size: 13px; display:flex; flex-direction:column; align-items:center; gap:5px;">
                <span style="font-size: 20px;">ğŸ“œ</span> Journal
            </button>
        </div>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
        <h3 style="margin: 0 0 10px 0; font-size: 12px; color: #94a3b8; text-transform: uppercase; text-align: left;">ğŸ’¾ DonnÃ©es</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
            <button class="btn btn-save" onclick="game.saveGame(); game.closeSaveManager();" style="grid-column: 1 / -1; padding: 12px;">Sauvegarder</button>
            <button class="btn" onclick="game.exportSaveFile()" style="background: #0dcaf0; color: white; padding: 10px; font-size: 11px;">â¬‡ï¸ Exporter</button>
            <button class="btn" onclick="game.importSaveFile()" style="background: #ffc107; color: #333; padding: 10px; font-size: 11px;">â¬†ï¸ Importer</button>
        </div>
        <div style="text-align: left; background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 20px;">
            <h3 style="margin: 0 0 10px 0; font-size: 12px; color: #94a3b8; text-transform: uppercase;">âš™ï¸ Options</h3>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span style="font-size: 13px; color: #334155; font-weight:bold;">ğŸ§¬ Smart Fusion</span>
                <button id="optSmartFusion" onclick="game.toggleSmartFusion()" class="btn" style="padding: 4px 10px; font-size: 11px; border-radius: 20px; min-width: 50px;">?</button>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-size: 13px; color: #334155; font-weight:bold;">ğŸ›‘ Pause Rare</span>
                <button id="optPauseRare" onclick="game.toggleRarePause()" class="btn" style="padding: 4px 10px; font-size: 11px; border-radius: 20px; min-width: 50px;">?</button>
            </div>
        </div>
        <div style="background: #fff5f5; border: 1px solid #fecaca; border-radius: 10px; padding: 10px;">
            <button class="btn btn-reset" onclick="resetGame()" style="width: 100%; font-size: 11px; padding: 8px;">ğŸ—‘ï¸ RÃ©initialiser le jeu</button>
        </div>
        <div style="margin-top: 15px; font-size: 10px; color: #cbd5e1;">v1.0.3</div>
    </div>
</div>

<div class="stats-modal" id="masteryModal" onclick="document.getElementById('masteryModal').classList.remove('show')">
    <div class="stats-content" style="max-width: 600px;" onclick="event.stopPropagation()">
        <div class="stats-header">
            <h2>ğŸ“œ MaÃ®trise des Biomes</h2>
            <button class="stats-close" onclick="document.getElementById('masteryModal').classList.remove('show')">Fermer</button>
        </div>
        <p style="color:#666; font-size:13px; margin-bottom:20px;">
            Effectuez des expÃ©ditions pour monter de niveau dans chaque biome et rÃ©duire la durÃ©e des trajets !
        </p>
        <div id="masteryListGrid" class="team-list" style="grid-template-columns: 1fr;"></div>
    </div>
</div>

<div id="customTooltip" class="custom-tooltip"></div>

<div id="logModal" class="modal">
    <div class="modal-content log-modal-content">
        <div class="modal-header-logs">
            <h2>ğŸ“œ Journal d'Aventure</h2>
            <button class="close-btn" onclick="game.closeLogModal()" style="background:none; border:none; color:#e2e8f0; font-size:28px; cursor:pointer; line-height:1;">&times;</button>
        </div>
        <div id="gameLog" class="log-console-scroll">
            <div class="log-entry" style="color:#94a3b8; font-style:italic; text-align:center; padding-top:20px;">
                Le journal enregistre les Ã©vÃ©nements importants...
            </div>
        </div>
        <div class="modal-footer-logs">
            <button class="btn" onclick="game.clearLogs()" style="background: #ef4444; color: white; border:none; padding: 8px 16px; border-radius:6px; cursor:pointer; font-size:12px; font-weight:600; transition: background 0.2s;">
                ğŸ—‘ï¸ Effacer l'historique
            </button>
        </div>
    </div>
</div>

<div id="offlineModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ğŸ’¤ Rapport de Veille</h2>
            <span class="close-modal" onclick="closeOfflineModal()">&times;</span>
        </div>
        <div class="modal-body">
            <p class="offline-time-text">Vous avez Ã©tÃ© absent pendant <span id="offlineTimeDisplay" class="highlight">00h 00m</span></p>
            <div class="offline-stats-grid">
                <div class="stat-box">
                    <span class="stat-icon">âš”ï¸</span>
                    <span id="offlineCombats" class="stat-value">0</span>
                    <span class="stat-label">Combats</span>
                </div>
                <div class="stat-box">
                    <span class="stat-icon">ğŸ†</span>
                    <span id="offlineWins" class="stat-value">0</span>
                    <span class="stat-label">Victoires</span>
                </div>
                <div class="stat-box">
                    <span class="stat-icon">ğŸ“¦</span>
                    <span id="offlineDrops" class="stat-value">0</span>
                    <span class="stat-label">Objets</span>
                </div>
                <div class="stat-box">
                    <span class="stat-icon">ğŸ•¸ï¸</span>
                    <span id="offlineCaptured" class="stat-value">0</span>
                    <span class="stat-label">CapturÃ©s</span>
                </div>
            </div>
            <div class="offline-loot-section">
                <div class="loot-header">DÃ©tails du Butin</div>
                <div id="offlineLootList" class="loot-list"></div>
            </div>
            <div class="offline-rewards">
                <div class="reward-row">
                    <span class="reward-label">âœ¨ ExpÃ©rience :</span>
                    <span id="offlineXp" class="reward-value xp-color">+0 XP</span>
                </div>
                <div class="reward-row">
                    <span class="reward-label">ğŸ’° PokÃ©dollars :</span>
                    <span id="offlineGold" class="reward-value gold-color">+0 $</span>
                </div>
            </div>
            <button class="modal-btn" onclick="closeOfflineModal()">RÃ©cupÃ©rer les gains</button>
        </div>
    </div>
</div>
